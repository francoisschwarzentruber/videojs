<html lang="fr">

<head>

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script id="MathJax-script" async src="lib/tex-mml-chtml.js"></script>

    <link href="engine.css" rel="stylesheet">
    <meta charset="UTF-8">

    <style>
        canvas {
            padding-left: 0;
            padding-right: 0;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }
    </style>
</head>

<body style="background: black">
    <canvas id="canvas" style="background: black" width="800" height="600">
    </canvas>
</body>

<script>

    CanvasRenderingContext2D.prototype.circle = function (x, y, r) {
        this.beginPath();
        this.arc(x, y, r, 0, 2 * Math.PI);
    }
    const nb = 200;
    const vertices = [];

    colors = [];


    function generateColor() {
        const r = Math.floor(255 * Math.random());
        const g = Math.floor(255 * Math.random());
        const b = Math.floor(255 * Math.random());

        if (r + g + b < 255)
            return generateColor();

        return `rgb(${r}, ${g}, ${b})`;

    }
    for (let i = 0; i < nb; i++) {
        colors[i] = generateColor();
        vertices.push({ x: Math.random() * 800, y: Math.random() * 600, degree: 0, class: i });
    }

    const edges = []
    const maxd = 4;
    for (let i = 0; i < vertices.length; i++)
        for (let j = i + 1; j < vertices.length; j++)
            //   if (vertices[i].degree < maxd && vertices[j].degree < maxd)
            if (Math.sqrt((vertices[i].x - vertices[j].x) ** 2 + (vertices[i].y - vertices[j].y) ** 2) < 100) {
                edges.push({ from: i, to: j, weight: Math.sqrt((vertices[i].x - vertices[j].x) ** 2 + (vertices[i].y - vertices[j].y) ** 2) });
                vertices[i].degree++;
                vertices[j].degree++;
            }


    edges.sort((e1, e2) => e1.weight - e2.weight);

    forest = [];


    function union(v1, v2) {
        const c1 = v1.class;
        const c2 = v2.class;

        for (let v of vertices) {
            if (v.class == c2)
                v.class = c1;
        }

    }



    function oneStep() {
        const e = edges[0];
        if (vertices[e.from].class != vertices[e.to].class) {
            forest.push(e);
            union(vertices[e.from], vertices[e.to]);
        }
        edges.shift();
        draw();
    }



    setInterval(oneStep, 10);


    function draw() {
        ctx = canvas.getContext("2d");

        ctx.setLineDash([1, 2]);
        for (const e of edges) {
            const v = 64;
            ctx.strokeStyle = `rgb(${v},${v}, ${v})`;
            ctx.beginPath();
            ctx.lineWidth = 1;
            ctx.moveTo(vertices[e.from].x, vertices[e.from].y);
            ctx.lineTo(vertices[e.to].x, vertices[e.to].y);
            ctx.stroke();
        }

        for (const point of vertices) {
            ctx.fillStyle = colors[point.class];
            ctx.circle(point.x, point.y, 3);
            ctx.fill();
        }

        ctx.setLineDash([]);
        for (const e of forest) {
            ctx.strokeStyle = colors[vertices[e.from].class];
            ctx.beginPath();
            ctx.lineWidth = 2;
            ctx.moveTo(vertices[e.from].x, vertices[e.from].y);
            ctx.lineTo(vertices[e.to].x, vertices[e.to].y);
            ctx.stroke();
        }

    }








</script>

</html>